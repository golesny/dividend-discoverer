language: nodes_js
node_js:
  - "10.15"
branches:
  only:
  - master
before_script:
  - sudo apt-get install -y sshpass
  - npm install -g @angular/cli
script:
  - cd webapp
  - npm install
  - ng build --prod
after_success:
  - echo "uploading to $FTP_SERVER"
  - cd ..
  - cp server/data.php webapp/dist/webapp/
  - cd webapp/dist/webapp/
  - ls -l
  - echo $SSH_KNOWN_HOST >> ~/.ssh/known_hosts
  - cat ~/.ssh/known_hosts
  - sshpass -p "$FTP_PASSWORD" scp -vrC * $FTP_USER@$FTP_SERVER:/
